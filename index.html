<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Baby Menu - Feeding Planner</title>
    
    <!-- PWA Meta Tags -->
    <meta name="description" content="Smart feeding planner for babies - plan daily complementary feeding menus with age-appropriate products">
    <meta name="theme-color" content="#3b82f6">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Baby Menu">
    <meta name="msapplication-TileColor" content="#3b82f6">
    <meta name="msapplication-tap-highlight" content="no">
    
    <!-- Additional PWA Meta Tags -->
    <meta name="application-name" content="Baby Menu">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-touch-fullscreen" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="msapplication-starturl" content="./index.html">
    <meta name="msapplication-navbutton-color" content="#3b82f6">
    <meta name="msapplication-TileImage" content="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQ0IiBoZWlnaHQ9IjE0NCIgdmlld0JveD0iMCAwIDE0NCAxNDQiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxNDQiIGhlaWdodD0iMTQ0IiByeD0iMTgiIGZpbGw9IiNmYmJmMjQiLz4KPHN2ZyB4PSIzNiIgeT0iMzYiIHdpZHRoPSI3MiIgaGVpZ2h0PSI3MiIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSIjMWUzYThhIj4KPHBhdGggZD0iTTEyIDJMMTMuMDkgOC4yNkwyMCA5TDEzLjA5IDE1Ljc0TDEyIDIyTDEwLjkxIDE1Ljc0TDQgOUwxMC45MSA4LjI2TDEyIDJaIi8+Cjwvc3ZnPgo8L3N2Zz4K">
    
    <!-- Дополнительные мобильные мета-теги -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="HandheldFriendly" content="true">
    <meta name="MobileOptimized" content="320">
    
    <!-- PWA Icons -->
    <link rel="apple-touch-icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyIiBoZWlnaHQ9IjE5MiIgdmlld0JveD0iMCAwIDE5MiAxOTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxOTIiIGhlaWdodD0iMTkyIiByeD0iMjQiIGZpbGw9IiNmYmJmMjQiLz4KPHN2ZyB4PSI0OCIgeT0iNDgiIHdpZHRoPSI5NiIgaGVpZ2h0PSI5NiIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSIjMWUzYThhIj4KPHBhdGggZD0iTTEyIDJMMTMuMDkgOC4yNkwyMCA5TDEzLjA5IDE1Ljc0TDEyIDIyTDEwLjkxIDE1Ljc0TDQgOUwxMC45MSA4LjI2TDEyIDJaIi8+Cjwvc3ZnPgo8L3N2Zz4K">
    <link rel="apple-touch-icon" sizes="180x180" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTgwIiBoZWlnaHQ9IjE4MCIgdmlld0JveD0iMCAwIDE4MCAxODAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxODAiIGhlaWdodD0iMTgwIiByeD0iMjIiIGZpbGw9IiNmYmJmMjQiLz4KPHN2ZyB4PSI0NSIgeT0iNDUiIHdpZHRoPSI5MCIgaGVpZ2h0PSI5MCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSIjMWUzYThhIj4KPHBhdGggZD0iTTEyIDJMMTMuMDkgOC4yNkwyMCA5TDEzLjA5IDE1Ljc0TDEyIDIyTDEwLjkxIDE1Ljc0TDQgOUwxMC45MSA4LjI2TDEyIDJaIi8+Cjwvc3ZnPgo8L3N2Zz4K">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyIiBoZWlnaHQ9IjE5MiIgdmlld0JveD0iMCAwIDE5MiAxOTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxOTIiIGhlaWdodD0iMTkyIiByeD0iMjQiIGZpbGw9IiNmYmJmMjQiLz4KPHN2ZyB4PSI0OCIgeT0iNDgiIHdpZHRoPSI5NiIgaGVpZ2h0PSI5NiIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSIjMWUzYThhIj4KPHBhdGggZD0iTTEyIDJMMTMuMDkgOC4yNkwyMCA5TDEzLjA5IDE1Ljc0TDEyIDIyTDEwLjkxIDE1Ljc0TDQgOUwxMC45MSA4LjI2TDEyIDJaIi8+Cjwvc3ZnPgo8L3N2Zz4K">
    <link rel="icon" type="image/png" sizes="32x32" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiByeD0iNCIgZmlsbD0iI2ZiYmYyNCIvPgo8c3ZnIHg9IjgiIHk9IjgiIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSIjMWUzYThhIj4KPHBhdGggZD0iTTEyIDJMMTMuMDkgOC4yNkwyMCA5TDEzLjA5IDE1Ljc0TDEyIDIyTDEwLjkxIDE1Ljc0TDQgOUwxMC45MSA4LjI2TDEyIDJaIi8+Cjwvc3ZnPgo8L3N2Zz4K">
    <link rel="icon" type="image/png" sizes="16x16" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2IiByeD0iMiIgZmlsbD0iI2ZiYmYyNCIvPgo8c3ZnIHg9IjQiIHk9IjQiIHdpZHRoPSI4IiBoZWlnaHQ9IjgiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0iIzFlM2E4YSI+CjxwYXRoIGQ9Ik0xMiAyTDEzLjA5IDguMjZMMjAgOUwxMy4wOSAxNS43NEwxMiAyMkwxMC45MSAxNS43NEw0IDlMMTAuOTEgOC4yNkwxMiAyWiIvPgo8L3N2Zz4KPC9zdmc+Cg==">
    
    <link rel="stylesheet" href="styles.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#1e3a8a">
</head>
<body>
    <!-- Main page -->
    <div id="main-page" class="page active">
        <div class="header">
            <h1>🍎 Baby Menu</h1>
            <p>Feeding planner for little ones</p>
            <button id="install-btn" class="install-btn" style="display: none;">
                📱 Install App
            </button>
            <div id="install-info" class="install-info" style="display: none;">
                <p>To install this app:</p>
                <ul>
                    <li><strong>Chrome/Edge:</strong> Tap the menu (⋮) → "Install app"</li>
                    <li><strong>Safari:</strong> Tap Share → "Add to Home Screen"</li>
                    <li><strong>Firefox:</strong> Tap the menu (⋮) → "Install"</li>
                </ul>
            </div>
        </div>
        
        <div class="content">
            <div class="welcome-section">
                <h2>Welcome!</h2>
                <p>Add a child and start planning their nutrition</p>
            </div>
            
            <div class="children-list" id="children-list">
                <!-- Children list will be loaded via JavaScript -->
            </div>
            
            <div class="main-actions">
                <button class="add-baby-btn" onclick="showAddBabyPage()">
                    <span class="btn-icon">👶</span>
                    Add Baby
                </button>
                <button class="stats-btn" onclick="showStatisticsPage()">
                    <span class="btn-icon">📊</span>
                    Statistics
                </button>
                <button class="settings-btn" onclick="showSettingsPage()">
                    <span class="btn-icon">⚙️</span>
                    Setup
                </button>
            </div>
        </div>
    </div>

    <!-- Add baby page -->
    <div id="add-baby-page" class="page">
        <div class="header">
            <button class="back-btn" onclick="showMainPage()">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M15 18L9 12L15 6" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </button>
            <h2>Add Baby</h2>
        </div>
        
        <div class="content">
            <form id="add-baby-form" onsubmit="addBaby(event)">
                <div class="form-group">
                    <label for="baby-name">Baby's name:</label>
                    <input type="text" id="baby-name" required placeholder="Enter name">
                </div>
                
                <div class="form-group">
                    <label>Gender:</label>
                    <div class="gender-selection">
                        <label class="gender-option">
                            <input type="radio" name="gender" value="boy">
                            <span class="gender-btn boy">👦 Boy</span>
                        </label>
                        <label class="gender-option">
                            <input type="radio" name="gender" value="girl">
                            <span class="gender-btn girl">👧 Girl</span>
                        </label>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="baby-birthdate">Birth date:</label>
                    <input type="date" id="baby-birthdate" required>
                </div>
                
                <button type="submit" class="submit-btn">Add Baby</button>
            </form>
        </div>
    </div>

    <!-- Baby page -->
    <div id="baby-page" class="page">
        <div class="header">
            <button class="back-btn" onclick="showMainPage()">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M15 18L9 12L15 6" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </button>
            <h2 id="baby-page-title">Baby</h2>
        </div>
        
        <div class="content">
            <div class="baby-info">
                <div class="baby-avatar" id="baby-avatar">👶</div>
                <div class="baby-details">
                    <h3 id="baby-name-display">Name</h3>
                    <p id="baby-age">Age</p>
                </div>
            </div>
            
            <div class="today-menu">
                <h3>Today give your baby:</h3>
                <div class="product-display" id="today-product">
                    <span class="product-emoji">🍎</span>
                    <span class="product-name">Apple</span>
                </div>
                <button class="fed-btn" onclick="markAsFed()">
                    <span class="btn-icon">☐</span>
                    Mark as Fed
                </button>
            </div>
            
            <div class="menu-actions">
                <button class="action-btn" onclick="showProductsPage()">
                    <span class="btn-icon">📝</span>
                    Manage Products
                </button>
                <button class="action-btn" onclick="showWeeklyPlannerPage()">
                    <span class="btn-icon">📅</span>
                    Weekly Planner
                </button>
            </div>
        </div>
    </div>

    <!-- Products management page -->
    <div id="products-page" class="page">
        <div class="header">
            <button class="back-btn" onclick="showBabyPage()">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M15 18L9 12L15 6" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </button>
            <h2>Feeding Products</h2>
        </div>
        
        <div class="content">
            <div class="add-product-section">
                <h3>Add product:</h3>
                <div class="add-product-form">
                    <div class="product-input-container">
                        <input type="text" id="new-product" placeholder="Type product name or select from list...">
                        <div id="product-suggestions" class="product-suggestions"></div>
                    </div>
                    <select id="product-category" class="category-select">
                        <option value="fruits">🍎 Fruits</option>
                        <option value="vegetables">🥕 Vegetables</option>
                        <option value="grains">🌾 Grains & Cereals</option>
                        <option value="proteins">🥩 Proteins</option>
                        <option value="dairy">🥛 Dairy</option>
                        <option value="other">🍯 Other</option>
                    </select>
                    <button onclick="addProduct()" class="add-product-btn">+</button>
                </div>
                <div class="popular-products">
                    <h4>Popular products:</h4>
                    <div id="popular-products-list" class="popular-products-grid">
                        <!-- Popular products will be loaded here -->
                    </div>
                </div>
            </div>
            
            <div class="products-list" id="products-list">
                <!-- Products list will be loaded via JavaScript -->
            </div>
        </div>
    </div>

    <!-- Weekly Planner page -->
    <div id="weekly-planner-page" class="page">
        <div class="header">
            <button class="back-btn" onclick="showBabyPage()">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M15 18L9 12L15 6" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </button>
            <h2>Weekly Planner</h2>
        </div>
        
        <div class="content">
            <div class="week-info">
                <div class="week-navigation">
                    <button class="week-nav-btn" onclick="changeWeek(-1)" id="prev-week-btn">
                        <span class="btn-icon">←</span>
                        Previous
                    </button>
                    <div class="week-title">
                        <h3 id="current-week">This Week</h3>
                        <p id="week-dates">Plan your baby's meals for the next 7 days</p>
                    </div>
                    <button class="week-nav-btn" onclick="changeWeek(1)" id="next-week-btn">
                        Next
                        <span class="btn-icon">→</span>
                    </button>
                </div>
            </div>
            
            <div class="weekly-menu" id="weekly-menu">
                <!-- Weekly menu will be created via JavaScript -->
            </div>
            
            <div class="planner-actions">
                <button class="action-btn" onclick="resetToAutomatic()">
                    <span class="btn-icon">🔄</span>
                    Reset to Automatic
                </button>
                <button class="action-btn" onclick="fillWeekAutomatically()">
                    <span class="btn-icon">✨</span>
                    Fill Week Automatically
                </button>
            </div>
        </div>
    </div>

    <!-- Custom Modal -->
    <div id="custom-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-title">Confirm Action</h3>
            </div>
            <div class="modal-body">
                <p id="modal-message">Are you sure?</p>
            </div>
            <div class="modal-footer">
                <button id="modal-cancel" class="modal-btn cancel-btn">Cancel</button>
                <button id="modal-confirm" class="modal-btn confirm-btn">OK</button>
            </div>
        </div>
    </div>

    <!-- Custom Alert -->
    <div id="custom-alert" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="alert-title">Notification</h3>
            </div>
            <div class="modal-body">
                <p id="alert-message">Message</p>
            </div>
            <div class="modal-footer">
                <button id="alert-ok" class="modal-btn confirm-btn">OK</button>
            </div>
        </div>
    </div>

    <!-- Custom Prompt -->
    <div id="custom-prompt" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="prompt-title">Enter Value</h3>
            </div>
            <div class="modal-body">
                <p id="prompt-message">Please enter a value:</p>
                <input type="text" id="prompt-input" placeholder="Enter value...">
            </div>
            <div class="modal-footer">
                <button id="prompt-cancel" class="modal-btn cancel-btn">Cancel</button>
                <button id="prompt-confirm" class="modal-btn confirm-btn">OK</button>
            </div>
        </div>
    </div>

    <!-- Settings page -->
    <div id="settings-page" class="page">
        <div class="header">
            <button class="back-btn" onclick="showMainPage()">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M15 18L9 12L15 6" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </button>
            <h2>Settings</h2>
        </div>
        
        <div class="content">
            <div class="settings-section">
                <h3>App Management</h3>
                <div class="settings-item">
                    <div class="settings-info">
                        <h4>Update App</h4>
                        <p>Force update the app to get the latest features and fixes</p>
                    </div>
                    <button class="update-app-btn" onclick="forceUpdateApp()">
                        <span class="btn-icon">🔄</span>
                        Update App
                    </button>
                </div>
            </div>
            
            <div class="settings-section">
                <h3>App Information</h3>
                <div class="app-info">
                    <div class="info-item">
                        <span class="info-label">Version:</span>
                        <span class="info-value">1.1.0</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Last Updated:</span>
                        <span class="info-value" id="last-updated">Just now</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Statistics Page -->
    <div id="statistics-page" class="page">
        <div class="header">
            <button class="back-btn" onclick="showMainPage()">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M15 18L9 12L15 6" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </button>
            <h2>Statistics</h2>
        </div>
        <div class="content">
            <div class="stats-container">
                <!-- Вкладки с детьми -->
                <div class="children-tabs" id="children-tabs">
                    <!-- Вкладки детей будут загружены через JavaScript -->
                </div>
                
                <div class="stats-tabs">
                    <button class="stats-tab active" onclick="showStatsTab('overview')">Overview</button>
                    <button class="stats-tab" onclick="showStatsTab('weekly')">Weekly</button>
                    <button class="stats-tab" onclick="showStatsTab('monthly')">Monthly</button>
                    <button class="stats-tab" onclick="showStatsTab('products')">Products</button>
                </div>
                
                <div class="stats-actions">
                    <button class="reset-stats-btn" onclick="resetStatistics()">
                        <span class="btn-icon">🗑️</span>
                        Reset Current
                    </button>
                    <button class="reset-all-stats-btn" onclick="resetAllStatistics()">
                        <span class="btn-icon">⚠️</span>
                        Reset All
                    </button>
                </div>
                
                <div id="stats-overview" class="stats-content active">
                    <div class="stats-header">
                        <h3 id="stats-baby-name">Statistics for: Loading...</h3>
                    </div>
                    <div class="stats-cards">
                        <div class="stats-card">
                            <div class="stats-icon">📊</div>
                            <div class="stats-info">
                                <h3 id="total-feedings">0</h3>
                                <p>Total Feedings</p>
                            </div>
                        </div>
                        <div class="stats-card">
                            <div class="stats-icon">📅</div>
                            <div class="stats-info">
                                <h3 id="days-tracked">0</h3>
                                <p>Days Tracked</p>
                            </div>
                        </div>
                        <div class="stats-card">
                            <div class="stats-icon">🍎</div>
                            <div class="stats-info">
                                <h3 id="unique-products">0</h3>
                                <p>Unique Products</p>
                            </div>
                        </div>
                        <div class="stats-card">
                            <div class="stats-icon">📈</div>
                            <div class="stats-info">
                                <h3 id="avg-per-day">0</h3>
                                <p>Avg per Day</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="stats-weekly" class="stats-content">
                    <div class="stats-chart">
                        <h3>Weekly Feeding Chart</h3>
                        <div id="weekly-chart" class="chart-container"></div>
                    </div>
                </div>
                
                <div id="stats-monthly" class="stats-content">
                    <div class="stats-chart">
                        <h3>Monthly Feeding Chart</h3>
                        <div id="monthly-chart" class="chart-container"></div>
                    </div>
                </div>
                
                <div id="stats-products" class="stats-content">
                    <div class="stats-chart">
                        <h3>Most Used Products</h3>
                        <div id="products-chart" class="chart-container"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js?v=7"></script>
    <script>
        // Проверка загрузки
        console.log('HTML loaded');
        
        // Проверяем через небольшую задержку
        setTimeout(function() {
            console.log('Functions available:', {
                showAddBabyPage: typeof showAddBabyPage,
                showStatisticsPage: typeof showStatisticsPage,
                showSettingsPage: typeof showSettingsPage,
                showPage: typeof showPage
            });
            
            // Тестируем кнопки
            const addBabyBtn = document.querySelector('.add-baby-btn');
            const statsBtn = document.querySelector('.stats-btn');
            const settingsBtn = document.querySelector('.settings-btn');
            
            console.log('Buttons found:', {
                addBabyBtn: !!addBabyBtn,
                statsBtn: !!statsBtn,
                settingsBtn: !!settingsBtn
            });
            
            if (addBabyBtn) {
                addBabyBtn.addEventListener('click', function() {
                    console.log('Add Baby button clicked');
                });
            }
            
            if (statsBtn) {
                statsBtn.addEventListener('click', function() {
                    console.log('Statistics button clicked');
                });
            }
            
            if (settingsBtn) {
                settingsBtn.addEventListener('click', function() {
                    console.log('Settings button clicked');
                });
            }
        }, 100);
    </script>
    
    <!-- PWA Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator && (location.protocol === 'http:' || location.protocol === 'https:')) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then(registration => {
                        console.log('SW registered: ', registration);
                    })
                    .catch(registrationError => {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }
    </script>
</body>
</html>
